# AI楽曲ギャラリーアプリ 要件定義書

## 1. プロジェクト概要

### 1.1 目的
AI生成楽曲を視覚的に楽しめる鑑賞体験を提供し、一般ユーザーにAI楽曲に親しんでもらうためのWebアプリケーション

### 1.2 ターゲットユーザー
- AI楽曲に興味がある一般ユーザー
- 音楽と視覚表現の融合体験を楽しみたいユーザー
- 将来的にはAI楽曲を生成して楽しみたいユーザー

## 2. 機能要件

### 2.1 フェーズ1（MVP）- フロントエンド完結版

#### 2.1.1 楽曲再生機能
- ローカルに配置された複数のAI生成楽曲を再生
- 横スクロール/フリックによる楽曲切り替え
- ランダム再生機能

#### 2.1.2 ビジュアライザー機能
- **音楽連動3D表現**
  - 音量・周波数に応じた3Dオブジェクトの変形
  - カメラアングルの動的変更
  - オブジェクト表面のテクスチャ変化
  - パーティクルエフェクトの連動
- **ビジュアライザーテーマ設定**
  - 複数のビジュアライザーパターン切り替え
  - PC: 右サイドバーに設定UI配置
  - スマホ: 画面下部に設定UI配置

#### 2.1.3 楽曲情報表示
- 楽曲タイトル
- AI生成ツール名
- ジャンル情報

### 2.2 フェーズ2 - バックエンド統合版

#### 2.2.1 ユーザー認証機能
- ログイン/ログアウト
- ユーザー登録

#### 2.2.2 お気に入り機能
- 楽曲のお気に入り登録/解除
- お気に入りリストの表示

#### 2.2.3 SNSシェア機能
- 現在再生中の楽曲をSNSでシェア
- ビジュアライザーのスクリーンショット付きシェア

#### 2.2.4 楽曲管理
- クラウドストレージ（S3）からの楽曲ストリーミング
- データベースによる楽曲メタデータ管理

### 2.3 フェーズ3 - 拡張機能

#### 2.3.1 AI楽曲生成機能
- ユーザーがアプリ内でAI楽曲を生成
- 生成した楽曲のギャラリーへの追加

#### 2.3.2 プレイリスト機能
- カスタムプレイリストの作成/編集
- プレイリストの共有

## 3. 非機能要件

### 3.1 パフォーマンス
- 3D表現と音楽再生の同期遅延: 50ms以内
- ページ読み込み時間: 3秒以内

### 3.2 ユーザビリティ
- レスポンシブデザイン（PC/タブレット/スマホ対応）
- 直感的な操作性（横スクロール/フリック）

### 3.3 互換性
- 対応ブラウザ: Chrome, Firefox, Safari, Edge（最新版）
- WebGL対応必須

## 4. 技術スタック

### 4.1 フロントエンド
- **フレームワーク**: React + TypeScript（必須）
- **ビルドツール**: Vite
- **3D表現**: Three.js + React Three Fiber
- **オーディオ解析**: Web Audio API
- **スタイリング**: CSS Modules / Styled Components
- **状態管理**: React Context API / Zustand
- **コード品質**: ESLint + Prettier（必須）
- **テストフレームワーク**: Vitest + React Testing Library
- **コンポーネント開発**: Storybook

### 4.2 バックエンド（フェーズ2以降）
- **API**: Node.js + Express / Next.js API Routes
- **データベース**: PostgreSQL / MySQL
- **認証**: NextAuth.js / Auth0
- **ストレージ**: AWS S3
- **ホスティング**: AWS / GCP

## 5. UI/UX設計

### 5.1 画面構成
- **メイン画面**: ビジュアライザー表示エリア
- **楽曲情報エリア**: 画面下部または上部に半透明で表示
- **ナビゲーション**: 
  - PC: 横スクロールボタン + 右サイドバー設定
  - スマホ: 横フリック + 下部設定パネル

### 5.2 インタラクション
- スムーズな楽曲切り替えアニメーション
- ビジュアライザー切り替え時のトランジション効果
- 設定変更のリアルタイム反映

## 6. 開発ガイドライン

### 6.1 開発手法
- **TDD（テスト駆動開発）** を必須とする

### 6.2 TDD開発フロー
1. **Red Phase（失敗するテストを書く）**
   - 新機能実装前に、必ず失敗するユニットテストを作成
   - テストケースは機能要件を満たすことを確認できる内容にする

2. **Green Phase（テストを通す）**
   - テストが通る最小限の実装を行う
   - この段階でコミット: `feat: <commit message>`

3. **Refactor Phase（リファクタリング）**
   - テストが通る状態を保ちながらコードを整理
   - 可読性、保守性を向上させる
   - 完了後にコミット: `refactor: <commit message>`

### 6.3 コミットメッセージ規約
- `feat:` 新機能追加
- `fix:` バグ修正
- `refactor:` リファクタリング
- `test:` テストの追加・修正
- `docs:` ドキュメントの更新
- `style:` コードスタイルの修正（フォーマット等）
- `chore:` ビルドプロセスやツールの設定変更

### 6.4 コード品質基準
- **TypeScript**: strictモードを有効化
- **ESLint**: プロジェクト標準の設定を厳守
- **Prettier**: 自動フォーマットを必須化
- **テストカバレッジ**: 主要機能は80%以上を目標

### 6.5 コンポーネント開発
- 新規UIコンポーネントはStorybookで独立して開発
- ビジュアルテストとインタラクションテストを作成

## 7. 開発スケジュール（参考）

### フェーズ1（1-2ヶ月）
1. 基本的なReactアプリケーション構築
2. Three.js統合と基本的な3D表現実装
3. Web Audio APIによる音楽解析実装
4. ビジュアライザーパターン実装（2-3種類）
5. レスポンシブUI実装

### フェーズ2（1-2ヶ月）
1. バックエンドAPI構築
2. データベース設計・実装
3. 認証機能実装
4. S3連携実装
5. お気に入り・シェア機能実装

### フェーズ3（2-3ヶ月）
1. AI楽曲生成API統合
2. 生成機能UI実装
3. プレイリスト機能実装
4. パフォーマンス最適化